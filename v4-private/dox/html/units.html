<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPQC-Docs: The Units Library</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeDarkModeToggle.init();
        DoxygenAwesomeParagraphLink.init();
    </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"$logosize/></td>
  <td id="projectalign">
   <div id="projectname">MPQC-Docs<span id="projectnumber">&#160;4.0.0-beta.1</span>
   </div>
   <div id="projectbrief">Massively Parallel Electronic Structure platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">The Units Library</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Motivation"></a>
Motivation</h1>
<p>Usually all electronic structure computations use atomic units for simplicity. The Units library supports precise and consistent use of quantities expressed in terms of units other than the atomic units. For example, atomic positions are typically specified in terms of angstroms. Conversion between angstroms and the atomic units of length (bohr) depends on the values of fundamental physical constants. Since the values of these constants are periodically revised, it is necessary to ensure that the values of fundamental constants can be easily updated and that the computational results obtained with the current values of the fundamental constants can be reproduced in the future. In other words, the user in 2026 should be able to say "perform a computation using the 2014 CODATA
physical constants" and reproduce the output generated in 2016. The Units library makes this easy.</p>
<h1><a class="anchor" id="Synopsis"></a>
Synopsis</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="units_8h.html">mpqc/chemistry/units/units.h</a>&quot;</span></div>
<div class="line">...</div>
<div class="ttc" id="aunits_8h_html"><div class="ttname"><a href="units_8h.html">units.h</a></div></div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <a class="code hl_function" href="classmpqc_1_1_unit_factory.html#a76ac4b223bd7ce280b4745e4a1c5384c">UnitFactory::set_default</a>(</div>
<div class="line">        <span class="stringliteral">&quot;2010CODATA&quot;</span>);  <span class="comment">// will use the 2010 CODATA revision of the physical</span></div>
<div class="line">                        <span class="comment">// constants</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// simple unit conversion</span></div>
<div class="line">    Unit ang = <a class="code hl_function" href="classmpqc_1_1_unit_factory.html#a24795e5f1e557e64d39ae4890220f7da">UnitFactory::get_default</a>()-&gt;make_unit(<span class="stringliteral">&quot;angstrom&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">ExEnv::out0</a>() &lt;&lt; <span class="stringliteral">&quot;1 angstrom = &quot;</span> &lt;&lt; ang.to_atomic_unit() &lt;&lt; <span class="stringliteral">&quot; bohr&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code hl_function" href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">ExEnv::out0</a>() &lt;&lt; <span class="stringliteral">&quot;1 bohr = &quot;</span> &lt;&lt; ang.from_atomic_unit() &lt;&lt; <span class="stringliteral">&quot; angstrom&quot;</span></div>
<div class="line">                  &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// composite unit conversion</span></div>
<div class="line">    Unit m_p_s2 = <a class="code hl_function" href="classmpqc_1_1_unit_factory.html#a24795e5f1e557e64d39ae4890220f7da">UnitFactory::get_default</a>()-&gt;make_unit(<span class="stringliteral">&quot;m / s * s&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">ExEnv::out0</a>() &lt;&lt; <span class="stringliteral">&quot;1 m/s^2 = &quot;</span> &lt;&lt; m_p_s2.to_atomic_unit()</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot; a.u. of acceleration&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code hl_function" href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">ExEnv::out0</a>() &lt;&lt; <span class="stringliteral">&quot;1 a.u. of acceleration = &quot;</span> &lt;&lt; m_p_s2.from_atomic_unit()</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot; m/s^2&quot;</span> &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// shorthand conversions from/to atomic units</span></div>
<div class="line">    <a class="code hl_function" href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">ExEnv::out0</a>() &lt;&lt; <span class="stringliteral">&quot;1 bohr = &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacempqc.html#a6585637a3ebfaf1d0ae6fd7b9c2a27c7">from_atomic_unit</a>(1, <span class="stringliteral">&quot;m&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; m&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code hl_function" href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">ExEnv::out0</a>() &lt;&lt; <span class="stringliteral">&quot;1 eV = &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacempqc.html#abe2ba7930edd80a092578eef21a0f8b8">to_atomic_unit</a>(1, <span class="stringliteral">&quot;eV&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; E_h&quot;</span> &lt;&lt; endl;</div>
<div class="ttc" id="aclassmpqc_1_1_ex_env_html_a9bff86d8c41e9444060de6c717df18c0"><div class="ttname"><a href="classmpqc_1_1_ex_env.html#a9bff86d8c41e9444060de6c717df18c0">mpqc::ExEnv::out0</a></div><div class="ttdeci">static std::ostream &amp; out0()</div><div class="ttdef"><b>Definition</b> exenv.cpp:104</div></div>
<div class="ttc" id="aclassmpqc_1_1_unit_factory_html_a24795e5f1e557e64d39ae4890220f7da"><div class="ttname"><a href="classmpqc_1_1_unit_factory.html#a24795e5f1e557e64d39ae4890220f7da">mpqc::UnitFactory::get_default</a></div><div class="ttdeci">static std::shared_ptr&lt; const UnitFactory &gt; get_default()</div><div class="ttdef"><b>Definition</b> units.cpp:148</div></div>
<div class="ttc" id="aclassmpqc_1_1_unit_factory_html_a76ac4b223bd7ce280b4745e4a1c5384c"><div class="ttname"><a href="classmpqc_1_1_unit_factory.html#a76ac4b223bd7ce280b4745e4a1c5384c">mpqc::UnitFactory::set_default</a></div><div class="ttdeci">static void set_default(const std::string &amp;system)</div><div class="ttdef"><b>Definition</b> units.cpp:152</div></div>
<div class="ttc" id="anamespacempqc_html_a6585637a3ebfaf1d0ae6fd7b9c2a27c7"><div class="ttname"><a href="namespacempqc.html#a6585637a3ebfaf1d0ae6fd7b9c2a27c7">mpqc::from_atomic_unit</a></div><div class="ttdeci">auto from_atomic_unit(Numeric input_value, const std::string &amp;output_unit_str)</div><div class="ttdef"><b>Definition</b> units.h:394</div></div>
<div class="ttc" id="anamespacempqc_html_abe2ba7930edd80a092578eef21a0f8b8"><div class="ttname"><a href="namespacempqc.html#abe2ba7930edd80a092578eef21a0f8b8">mpqc::to_atomic_unit</a></div><div class="ttdeci">auto to_atomic_unit(Numeric input_value, const std::string &amp;input_unit_str)</div><div class="ttdef"><b>Definition</b> units.h:381</div></div>
</div><!-- fragment --><h1><a class="anchor" id="units_using"></a>
Using the library</h1>
<p>To use the library follow these steps.</p><ul>
<li>#include the <code><a class="el" href="units_8h.html">mpqc/chemistry/units/units.h</a></code> header.</li>
<li>Create a <a class="el" href="classmpqc_1_1_unit_factory.html">UnitFactory</a> object for the desired fundamental constants system. It makes sense to use <a class="el" href="classmpqc_1_1_unit_factory.html">UnitFactory</a> as a singleton object so that every piece of code in your program uses the same fundamental constants. If you are happy with the default choice (currently, it is <a href="https://physics.nist.gov/cuu/Constants/index.html">the 2022 CODATA revision</a>), access the default <a class="el" href="classmpqc_1_1_unit_factory.html">UnitFactory</a> object via the <a class="el" href="classmpqc_1_1_unit_factory.html#a24795e5f1e557e64d39ae4890220f7da">UnitFactory::get_default()</a> static method. It is recommended that you set the default <a class="el" href="classmpqc_1_1_unit_factory.html">UnitFactory</a> explicitly by calling the <a class="el" href="classmpqc_1_1_unit_factory.html#a76ac4b223bd7ce280b4745e4a1c5384c">UnitFactory::set_default()</a> static method (see <a class="el" href="classmpqc_1_1_unit_factory.html#a24c31b32f43159b7bae2f05979d933f1">UnitFactory::UnitFactory()</a> ctor documentation for the list of recognized arguments to the set_default method).</li>
<li>Use {<a class="el" href="namespacempqc.html#abe2ba7930edd80a092578eef21a0f8b8">to_atomic_unit()</a>,<a class="el" href="namespacempqc.html#a6585637a3ebfaf1d0ae6fd7b9c2a27c7">from_atomic_unit()</a>} to convert a value to/from atomic units. These methods are shortcuts for the following:<ul>
<li><a class="el" href="classmpqc_1_1_unit_factory.html#a28a5dfa633b9046d53ddac8244355530">UnitFactory::make_unit()</a> method to used to create a <a class="el" href="classmpqc_1_1_unit.html" title="The Unit class is used to perform unit conversions.">Unit</a> object for the desired unit. The method accepts a std::string describing the unit, which can be a simple or a composite unit (see Unit::Unit() documentation for the description).</li>
<li>The <a class="el" href="classmpqc_1_1_unit.html" title="The Unit class is used to perform unit conversions.">Unit</a> object is used to determine the conversion factors between the unit and the corresponding unit in the atomic units system.</li>
</ul>
</li>
</ul>
<p>Since it is guaranteed that the definitions of the physical constants will change periodically, it is recommened that for the sake of reproducibility reference computations should specify the units explicitly. For example, all MPQC reference inputs used to validate the package must specify the desired fundamental constants system via the <code>"units"</code> keyword (see <a class="el" href="mpqcinp.html">MPQC Object-Oriented Input</a> for more information). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 13 2025 23:43:46 for MPQC-Docs by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
